<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="5005px" preserveAspectRatio="none" style="width:3013px;height:5005px;" version="1.1" viewBox="0 0 3013 5005" width="3013px" zoomAndPan="magnify"><defs><filter height="300%" id="f5wpn67bfdwty" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#D3D3D3" height="4990.6406" style="stroke: #383838; stroke-width: 1.0;" width="1078" x="1009.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="182" x="1457.5" y="26.8379">Payment Manager</text><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="1899.5781" style="stroke: #383838; stroke-width: 1.0;" width="10" x="2019.5" y="545.4063"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="1988.25" style="stroke: #383838; stroke-width: 1.0;" width="10" x="2024.5" y="2920.0469"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="1118.8125" style="stroke: #383838; stroke-width: 1.0;" width="10" x="2024.5" y="2920.0469"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="529.7344" style="stroke: #383838; stroke-width: 1.0;" width="10" x="2024.5" y="4273.2188"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="170.3594" style="stroke: #000000; stroke-width: 2.0;" width="596.5" x="775" y="306.7031"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="556.4063" style="stroke: #000000; stroke-width: 2.0;" width="1163.5" x="1816" y="560.4063"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="584.0781" style="stroke: #000000; stroke-width: 2.0;" width="1122.5" x="1765" y="1176.4844"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="584.0781" style="stroke: #000000; stroke-width: 2.0;" width="1104.5" x="1765" y="1820.2344"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="170.3594" style="stroke: #000000; stroke-width: 2.0;" width="608.5" x="775" y="2681.3438"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="419.3906" style="stroke: #000000; stroke-width: 2.0;" width="1175.5" x="1816" y="2935.0469"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="584.0781" style="stroke: #000000; stroke-width: 2.0;" width="1085.5" x="1765" y="3414.1094"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="474.0625" style="stroke: #000000; stroke-width: 2.0;" width="1104.5" x="1765" y="4288.2188"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="120" x2="120" y1="110.0156" y2="4917.2969"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1072.5" x2="1072.5" y1="110.0156" y2="4917.2969"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2024.5" x2="2024.5" y1="110.0156" y2="4917.2969"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="2492.5" x2="2492.5" y1="110.0156" y2="4917.2969"/><rect fill="#F8F8F8" filter="url(#f5wpn67bfdwty)" height="41.6719" style="stroke: #383838; stroke-width: 1.5;" width="221" x="8" y="63.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="207" x="15" y="93.1816">Core banking solution</text><rect fill="#F8F8F8" filter="url(#f5wpn67bfdwty)" height="41.6719" style="stroke: #383838; stroke-width: 1.5;" width="221" x="8" y="4916.2969"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="207" x="15" y="4946.1348">Core banking solution</text><rect fill="#F8F8F8" filter="url(#f5wpn67bfdwty)" height="69.3438" style="stroke: #383838; stroke-width: 1.5;" width="114" x="1013.5" y="35.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="48" x="1046.5" y="65.5098">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="100" x="1020.5" y="93.1816">Connector</text><rect fill="#F8F8F8" filter="url(#f5wpn67bfdwty)" height="69.3438" style="stroke: #383838; stroke-width: 1.5;" width="114" x="1013.5" y="4916.2969"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="48" x="1046.5" y="4946.1348">Core</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="100" x="1020.5" y="4973.8066">Connector</text><rect fill="#F8F8F8" filter="url(#f5wpn67bfdwty)" height="69.3438" style="stroke: #383838; stroke-width: 1.5;" width="114" x="1965.5" y="35.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="90" x="1977.5" y="65.5098">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="100" x="1972.5" y="93.1816">Connector</text><rect fill="#F8F8F8" filter="url(#f5wpn67bfdwty)" height="69.3438" style="stroke: #383838; stroke-width: 1.5;" width="114" x="1965.5" y="4916.2969"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="90" x="1977.5" y="4946.1348">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="100" x="1972.5" y="4973.8066">Connector</text><rect fill="#F8F8F8" filter="url(#f5wpn67bfdwty)" height="69.3438" style="stroke: #383838; stroke-width: 1.5;" width="104" x="2438.5" y="35.6719"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="90" x="2445.5" y="65.5098">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="63" x="2459" y="93.1816">Switch</text><rect fill="#F8F8F8" filter="url(#f5wpn67bfdwty)" height="69.3438" style="stroke: #383838; stroke-width: 1.5;" width="104" x="2438.5" y="4916.2969"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="90" x="2445.5" y="4946.1348">Mojaloop</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="63" x="2459" y="4973.8066">Switch</text><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="1899.5781" style="stroke: #383838; stroke-width: 1.0;" width="10" x="2019.5" y="545.4063"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="1988.25" style="stroke: #383838; stroke-width: 1.0;" width="10" x="2024.5" y="2920.0469"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="1118.8125" style="stroke: #383838; stroke-width: 1.0;" width="10" x="2024.5" y="2920.0469"/><rect fill="#FFFFFF" filter="url(#f5wpn67bfdwty)" height="529.7344" style="stroke: #383838; stroke-width: 1.0;" width="10" x="2024.5" y="4273.2188"/><rect fill="#EEEEEE" filter="url(#f5wpn67bfdwty)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2998.5" x="3" y="146.8516"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3001.5" y1="146.8516" y2="146.8516"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3001.5" y1="149.8516" y2="149.8516"/><rect fill="#EEEEEE" filter="url(#f5wpn67bfdwty)" height="35.6719" style="stroke: #000000; stroke-width: 2.0;" width="584" x="1210.25" y="130.0156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="564" x="1216.25" y="156.8535">Payer DFSP integration - 2 phase commit - single phase</text><line style="stroke: #383838; stroke-width: 1.0;" x1="120.5" x2="162.5" y1="209.3594" y2="209.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="162.5" x2="162.5" y1="209.3594" y2="222.3594"/><line style="stroke: #383838; stroke-width: 1.0;" x1="121.5" x2="162.5" y1="222.3594" y2="222.3594"/><polygon fill="#383838" points="131.5,218.3594,121.5,222.3594,131.5,226.3594,127.5,222.3594" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="127.5" y="202.5254">[1]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="139" x="157.5" y="202.5254">Reserve funds</text><polygon fill="#383838" points="1060.5,287.7031,1070.5,291.7031,1060.5,295.7031,1064.5,291.7031" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="120.5" x2="1066.5" y1="291.7031" y2="291.7031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="127.5" y="271.0332">[2]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="157.5" y="257.1973">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="175" x="225.5" y="257.1973">/bulkDisbursement</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="874" x="157.5" y="284.8691">(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true, synchronous = false)</text><path d="M775,306.7031 L864,306.7031 L864,325.7031 L854,335.7031 L775,335.7031 L775,306.7031 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="170.3594" style="stroke: #000000; stroke-width: 2.0;" width="596.5" x="775" y="306.7031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="790" y="330.541">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="210" x="879" y="331.541">[n times  (in parallel)]</text><polygon fill="#ECECEC" filter="url(#f5wpn67bfdwty)" points="795,354.0469,1057,354.0469,1067,385.0469,1057,417.0469,795,417.0469,785,385.0469,795,354.0469" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="258" x="797" y="380.8848">For each individual transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="153" x="797" y="408.5566">in bulk message</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1072.5" x2="1114.5" y1="456.0625" y2="456.0625"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1114.5" x2="1114.5" y1="456.0625" y2="469.0625"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1073.5" x2="1114.5" y1="469.0625" y2="469.0625"/><polygon fill="#383838" points="1083.5,465.0625,1073.5,469.0625,1083.5,473.0625,1079.5,469.0625" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="1079.5" y="449.2285">[3]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="250" x="1109.5" y="449.2285">validate MSISDN &amp; Prefix</text><polygon fill="#383838" points="2007.5,541.4063,2017.5,545.4063,2007.5,549.4063,2011.5,545.4063" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1072.5" x2="2013.5" y1="545.4063" y2="545.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="1079.5" y="524.7363">[4]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1109.5" y="510.9004">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="135" x="1177.5" y="510.9004">/bulkTransfers</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="874" x="1109.5" y="538.5723">(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true, synchronous = false)</text><path d="M1816,560.4063 L1905,560.4063 L1905,579.4063 L1895,589.4063 L1816,589.4063 L1816,560.4063 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="556.4063" style="stroke: #000000; stroke-width: 2.0;" width="1163.5" x="1816" y="560.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1831" y="584.2441">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="545" x="1920" y="585.2441">[N times &amp; within bulkExpiration timelimit  (in parallel)]</text><polygon fill="#ECECEC" filter="url(#f5wpn67bfdwty)" points="1836,607.75,2004,607.75,2014,638.75,2004,670.75,1836,670.75,1826,638.75,1836,607.75" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="164" x="1838" y="634.5879">For each transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="153" x="1838" y="662.2598">in bulk message</text><polygon fill="#383838" points="2480.5,705.7656,2490.5,709.7656,2480.5,713.7656,2484.5,709.7656" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2486.5" y1="709.7656" y2="709.7656"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="2036.5" y="702.9316">[5]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="2066.5" y="702.9316">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="258" x="2119.5" y="702.9316">/parties/{Type}/{ID}/{SubId}</text><polygon fill="#383838" points="2040.5,747.4375,2030.5,751.4375,2040.5,755.4375,2036.5,751.4375" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2034.5" x2="2491.5" y1="751.4375" y2="751.4375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="2046.5" y="744.6035">[6]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="196" x="2076.5" y="744.6035">HTTP 202 response</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="793.1094" y2="793.1094"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="793.1094" y2="806.1094"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="806.1094" y2="806.1094"/><polygon fill="#383838" points="2503.5,802.1094,2493.5,806.1094,2503.5,810.1094,2499.5,806.1094" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="2499.5" y="786.2754">[7]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="353" x="2529.5" y="786.2754">Determine Payee DFSP using oracle</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="875.4531" y2="875.4531"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="875.4531" y2="888.4531"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="888.4531" y2="888.4531"/><polygon fill="#383838" points="2503.5,884.4531,2493.5,888.4531,2503.5,892.4531,2499.5,888.4531" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="2499.5" y="854.7832">[8]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="438" x="2529.5" y="840.9473">Lookup Payee Information from Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="50" x="2535.5" y="868.6191">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="2591.5" y="868.6191">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="71" x="2644.5" y="868.6191">/parties</text><polygon fill="#383838" points="2040.5,926.125,2030.5,930.125,2040.5,934.125,2036.5,930.125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2491.5" y1="930.125" y2="930.125"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="2046.5" y="923.291">[9]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="2076.5" y="923.291">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="258" x="2128.5" y="923.291">/parties/{Type}/{ID}/{SubId}</text><polygon fill="#383838" points="2480.5,967.7969,2490.5,971.7969,2480.5,975.7969,2484.5,971.7969" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2029.5" x2="2486.5" y1="971.7969" y2="971.7969"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="964.9629">[10]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="205" x="2078.5" y="964.9629">HTTP 200 Response</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2071.5" y1="1041.1406" y2="1041.1406"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2071.5" x2="2071.5" y1="1041.1406" y2="1054.1406"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2030.5" x2="2071.5" y1="1054.1406" y2="1054.1406"/><polygon fill="#383838" points="2040.5,1050.1406,2030.5,1054.1406,2040.5,1058.1406,2036.5,1054.1406" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="1020.4707">[11]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="285" x="2078.5" y="1006.6348">Update transaction status and</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="260" x="2084.5" y="1034.3066">attach get parties response</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2071.5" y1="1095.8125" y2="1095.8125"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2071.5" x2="2071.5" y1="1095.8125" y2="1108.8125"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2030.5" x2="2071.5" y1="1108.8125" y2="1108.8125"/><polygon fill="#383838" points="2040.5,1104.8125,2030.5,1108.8125,2040.5,1112.8125,2036.5,1108.8125" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="1088.9785">[12]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="302" x="2078.5" y="1088.9785">Add to next phase FSP bulk call</text><rect fill="#ECECEC" filter="url(#f5wpn67bfdwty)" height="35" style="stroke: #383838; stroke-width: 1.0;" width="132" x="1882" y="1128.8125"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="124" x="1886" y="1155.6504">Accept Party</text><path d="M1765,1176.4844 L1854,1176.4844 L1854,1195.4844 L1844,1205.4844 L1765,1205.4844 L1765,1176.4844 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="584.0781" style="stroke: #000000; stroke-width: 2.0;" width="1122.5" x="1765" y="1176.4844"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1780" y="1200.3223">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="729" x="1869" y="1201.3223">[Quote Processing (M times &amp; within bulkExpiration timelimit in parallel)]</text><polygon fill="#ECECEC" filter="url(#f5wpn67bfdwty)" points="1785,1223.8281,2004,1223.8281,2014,1254.8281,2004,1286.8281,1785,1286.8281,1775,1254.8281,1785,1223.8281" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="215" x="1787" y="1250.666">For each payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="153" x="1787" y="1278.3379">in bulk message</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2071.5" y1="1325.8438" y2="1325.8438"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2071.5" x2="2071.5" y1="1325.8438" y2="1338.8438"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2030.5" x2="2071.5" y1="1338.8438" y2="1338.8438"/><polygon fill="#383838" points="2040.5,1334.8438,2030.5,1338.8438,2040.5,1342.8438,2036.5,1338.8438" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="1319.0098">[13]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="199" x="2078.5" y="1319.0098">Check bulkExpiration</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2071.5" y1="1380.5156" y2="1380.5156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2071.5" x2="2071.5" y1="1380.5156" y2="1393.5156"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2030.5" x2="2071.5" y1="1393.5156" y2="1393.5156"/><polygon fill="#383838" points="2040.5,1389.5156,2030.5,1393.5156,2040.5,1397.5156,2036.5,1393.5156" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="1373.6816">[14]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="239" x="2078.5" y="1373.6816">Create bulkTransactionId</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2071.5" y1="1490.5313" y2="1490.5313"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2071.5" x2="2071.5" y1="1490.5313" y2="1503.5313"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2030.5" x2="2071.5" y1="1503.5313" y2="1503.5313"/><polygon fill="#383838" points="2040.5,1499.5313,2030.5,1503.5313,2040.5,1507.5313,2036.5,1503.5313" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="1456.0254">[15]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="194" x="2078.5" y="1428.3535">Calculate bulk expiry</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="391" x="2078.5" y="1456.0254">based on both expirySeconds config and</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="133" x="2078.5" y="1483.6973">bulkExpiration</text><polygon fill="#383838" points="2480.5,1541.2031,2490.5,1545.2031,2480.5,1549.2031,2484.5,1545.2031" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2486.5" y1="1545.2031" y2="1545.2031"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="1538.3691">[16]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="2078.5" y="1538.3691">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="108" x="2146.5" y="1538.3691">/bulkquotes</text><polygon fill="#383838" points="2040.5,1582.875,2030.5,1586.875,2040.5,1590.875,2036.5,1586.875" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2034.5" x2="2491.5" y1="1586.875" y2="1586.875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2046.5" y="1580.041">[17]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="196" x="2088.5" y="1580.041">HTTP 202 response</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="1656.2188" y2="1656.2188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="1656.2188" y2="1669.2188"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="1669.2188" y2="1669.2188"/><polygon fill="#383838" points="2503.5,1665.2188,2493.5,1669.2188,2503.5,1673.2188,2499.5,1669.2188" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="1635.5488">[18]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="334" x="2541.5" y="1621.7129">Pass on bulkquote to Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="50" x="2547.5" y="1649.3848">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="2603.5" y="1649.3848">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="108" x="2671.5" y="1649.3848">/bulkquotes</text><polygon fill="#383838" points="2040.5,1706.8906,2030.5,1710.8906,2040.5,1714.8906,2036.5,1710.8906" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2491.5" y1="1710.8906" y2="1710.8906"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2046.5" y="1704.0566">[19]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="2088.5" y="1704.0566">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="146" x="2140.5" y="1704.0566">/bulkquotes/{Id}</text><polygon fill="#383838" points="2480.5,1748.5625,2490.5,1752.5625,2480.5,1756.5625,2484.5,1752.5625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2029.5" x2="2486.5" y1="1752.5625" y2="1752.5625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="1745.7285">[20]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="205" x="2078.5" y="1745.7285">HTTP 200 Response</text><rect fill="#ECECEC" filter="url(#f5wpn67bfdwty)" height="35" style="stroke: #383838; stroke-width: 1.0;" width="140" x="1874" y="1772.5625"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="132" x="1878" y="1799.4004">Accept Quote</text><path d="M1765,1820.2344 L1854,1820.2344 L1854,1839.2344 L1844,1849.2344 L1765,1849.2344 L1765,1820.2344 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="584.0781" style="stroke: #000000; stroke-width: 2.0;" width="1104.5" x="1765" y="1820.2344"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1780" y="1844.0723">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="760" x="1869" y="1845.0723">[Transfer Processing (M times &amp; within bulkExpiration timelimit  in parallel)]</text><polygon fill="#ECECEC" filter="url(#f5wpn67bfdwty)" points="1785,1867.5781,2004,1867.5781,2014,1898.5781,2004,1930.5781,1785,1930.5781,1775,1898.5781,1785,1867.5781" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="215" x="1787" y="1894.416">For each payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="153" x="1787" y="1922.0879">in bulk message</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2071.5" y1="2024.9375" y2="2024.9375"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2071.5" x2="2071.5" y1="2024.9375" y2="2037.9375"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2030.5" x2="2071.5" y1="2037.9375" y2="2037.9375"/><polygon fill="#383838" points="2040.5,2033.9375,2030.5,2037.9375,2040.5,2041.9375,2036.5,2037.9375" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="1990.4316">[21]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="374" x="2078.5" y="1962.7598">Confirm Fees meets auto accept levels</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="378" x="2084.5" y="1990.4316">and bulkExpiration timelimit not reached</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="250" x="2078.5" y="2018.1035">-&gt; Update Transfer Status</text><polygon fill="#383838" points="2480.5,2075.6094,2490.5,2079.6094,2480.5,2083.6094,2484.5,2079.6094" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2029.5" x2="2486.5" y1="2079.6094" y2="2079.6094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="2072.7754">[22]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="2078.5" y="2072.7754">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="127" x="2146.5" y="2072.7754">/bulktransfers</text><polygon fill="#383838" points="2040.5,2117.2813,2030.5,2121.2813,2040.5,2125.2813,2036.5,2121.2813" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2034.5" x2="2491.5" y1="2121.2813" y2="2121.2813"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2046.5" y="2114.4473">[23]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="196" x="2088.5" y="2114.4473">HTTP 202 response</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="2162.9531" y2="2162.9531"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="2162.9531" y2="2175.9531"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="2175.9531" y2="2175.9531"/><polygon fill="#383838" points="2503.5,2171.9531,2493.5,2175.9531,2503.5,2179.9531,2499.5,2175.9531" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="2156.1191">[24]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="267" x="2541.5" y="2156.1191">Reserve Payer DFSP funds</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="2245.2969" y2="2245.2969"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="2245.2969" y2="2258.2969"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="2258.2969" y2="2258.2969"/><polygon fill="#383838" points="2503.5,2254.2969,2493.5,2258.2969,2503.5,2262.2969,2499.5,2258.2969" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="2224.627">[25]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="316" x="2541.5" y="2210.791">Pass on transfer to Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="50" x="2547.5" y="2238.4629">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="2603.5" y="2238.4629">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="127" x="2671.5" y="2238.4629">/bulktransfers</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="2299.9688" y2="2299.9688"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="2299.9688" y2="2312.9688"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="2312.9688" y2="2312.9688"/><polygon fill="#383838" points="2503.5,2308.9688,2493.5,2312.9688,2503.5,2316.9688,2499.5,2312.9688" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="2293.1348">[26]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="262" x="2541.5" y="2293.1348">Commit Payer DFSP funds</text><polygon fill="#383838" points="2040.5,2350.6406,2030.5,2354.6406,2040.5,2358.6406,2036.5,2354.6406" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2491.5" y1="2354.6406" y2="2354.6406"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2046.5" y="2347.8066">[27]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="2088.5" y="2347.8066">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="165" x="2140.5" y="2347.8066">/bulktransfers/{Id}</text><polygon fill="#383838" points="2480.5,2392.3125,2490.5,2396.3125,2480.5,2400.3125,2484.5,2396.3125" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2029.5" x2="2486.5" y1="2396.3125" y2="2396.3125"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2036.5" y="2389.4785">[28]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="205" x="2078.5" y="2389.4785">HTTP 200 Response</text><polygon fill="#383838" points="1083.5,2440.9844,1073.5,2444.9844,1083.5,2448.9844,1079.5,2444.9844" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1077.5" x2="2023.5" y1="2444.9844" y2="2444.9844"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="1089.5" y="2438.1504">[29]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1131.5" y="2438.1504">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="165" x="1183.5" y="2438.1504">/bulktransfers/{Id}</text><polygon fill="#383838" points="131.5,2482.6563,121.5,2486.6563,131.5,2490.6563,127.5,2486.6563" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="125.5" x2="1071.5" y1="2486.6563" y2="2486.6563"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="137.5" y="2479.8223">[30]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="179.5" y="2479.8223">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="209" x="231.5" y="2479.8223">/bulkdisbursement/{Id}</text><line style="stroke: #383838; stroke-width: 1.0;" x1="120.5" x2="162.5" y1="2528.3281" y2="2528.3281"/><line style="stroke: #383838; stroke-width: 1.0;" x1="162.5" x2="162.5" y1="2528.3281" y2="2541.3281"/><line style="stroke: #383838; stroke-width: 1.0;" x1="121.5" x2="162.5" y1="2541.3281" y2="2541.3281"/><polygon fill="#383838" points="131.5,2537.3281,121.5,2541.3281,131.5,2545.3281,127.5,2541.3281" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="127.5" y="2521.4941">[31]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="134" x="169.5" y="2521.4941">Commit funds</text><rect fill="#EEEEEE" filter="url(#f5wpn67bfdwty)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="2998.5" x="3" y="2576.1641"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3001.5" y1="2576.1641" y2="2576.1641"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="3001.5" y1="2579.1641" y2="2579.1641"/><rect fill="#EEEEEE" filter="url(#f5wpn67bfdwty)" height="35.6719" style="stroke: #000000; stroke-width: 2.0;" width="684" x="1160.25" y="2559.3281"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="664" x="1166.25" y="2586.166">Payer DFSP integration - 2 phase commit - with user confirmation</text><polygon fill="#383838" points="1060.5,2662.3438,1070.5,2666.3438,1060.5,2670.3438,1064.5,2666.3438" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="120.5" x2="1066.5" y1="2666.3438" y2="2666.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="127.5" y="2645.6738">[32]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="169.5" y="2631.8379">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="175" x="237.5" y="2631.8379">/bulkDisbursement</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="621" x="169.5" y="2659.5098">(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES =</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="48" x="796.5" y="2659.5098">false</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="211" x="844.5" y="2659.5098">, synchronous = false)</text><path d="M775,2681.3438 L864,2681.3438 L864,2700.3438 L854,2710.3438 L775,2710.3438 L775,2681.3438 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="170.3594" style="stroke: #000000; stroke-width: 2.0;" width="608.5" x="775" y="2681.3438"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="790" y="2705.1816">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="210" x="879" y="2706.1816">[n times  (in parallel)]</text><polygon fill="#ECECEC" filter="url(#f5wpn67bfdwty)" points="795,2728.6875,1057,2728.6875,1067,2759.6875,1057,2791.6875,795,2791.6875,785,2759.6875,795,2728.6875" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="258" x="797" y="2755.5254">For each individual transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="153" x="797" y="2783.1973">in bulk message</text><line style="stroke: #383838; stroke-width: 1.0;" x1="1072.5" x2="1114.5" y1="2830.7031" y2="2830.7031"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1114.5" x2="1114.5" y1="2830.7031" y2="2843.7031"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1073.5" x2="1114.5" y1="2843.7031" y2="2843.7031"/><polygon fill="#383838" points="1083.5,2839.7031,1073.5,2843.7031,1083.5,2847.7031,1079.5,2843.7031" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="1079.5" y="2823.8691">[33]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="250" x="1121.5" y="2823.8691">validate MSISDN &amp; Prefix</text><polygon fill="#383838" points="2012.5,2916.0469,2022.5,2920.0469,2012.5,2924.0469,2016.5,2920.0469" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1072.5" x2="2018.5" y1="2920.0469" y2="2920.0469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="1079.5" y="2899.377">[34]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="1121.5" y="2885.541">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="135" x="1189.5" y="2885.541">/bulkTransfers</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="621" x="1121.5" y="2913.2129">(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES =</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="48" x="1748.5" y="2913.2129">false</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="211" x="1796.5" y="2913.2129">, synchronous = false)</text><path d="M1816,2935.0469 L1905,2935.0469 L1905,2954.0469 L1895,2964.0469 L1816,2964.0469 L1816,2935.0469 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="419.3906" style="stroke: #000000; stroke-width: 2.0;" width="1175.5" x="1816" y="2935.0469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1831" y="2958.8848">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="545" x="1920" y="2959.8848">[N times &amp; within bulkExpiration timelimit  (in parallel)]</text><polygon fill="#ECECEC" filter="url(#f5wpn67bfdwty)" points="1836,2982.3906,2004,2982.3906,2014,3013.3906,2004,3045.3906,1836,3045.3906,1826,3013.3906,1836,2982.3906" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="164" x="1838" y="3009.2285">For each transfer</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="153" x="1838" y="3036.9004">in bulk message</text><polygon fill="#383838" points="2480.5,3080.4063,2490.5,3084.4063,2480.5,3088.4063,2484.5,3084.4063" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2486.5" y1="3084.4063" y2="3084.4063"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="3077.5723">[35]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="2083.5" y="3077.5723">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="258" x="2136.5" y="3077.5723">/parties/{Type}/{ID}/{SubId}</text><polygon fill="#383838" points="2045.5,3122.0781,2035.5,3126.0781,2045.5,3130.0781,2041.5,3126.0781" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2039.5" x2="2491.5" y1="3126.0781" y2="3126.0781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2051.5" y="3119.2441">[36]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="196" x="2093.5" y="3119.2441">HTTP 202 response</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="3167.75" y2="3167.75"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="3167.75" y2="3180.75"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="3180.75" y2="3180.75"/><polygon fill="#383838" points="2503.5,3176.75,2493.5,3180.75,2503.5,3184.75,2499.5,3180.75" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="3160.916">[37]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="353" x="2541.5" y="3160.916">Determine Payee DFSP using oracle</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="3250.0938" y2="3250.0938"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="3250.0938" y2="3263.0938"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="3263.0938" y2="3263.0938"/><polygon fill="#383838" points="2503.5,3259.0938,2493.5,3263.0938,2503.5,3267.0938,2499.5,3263.0938" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="3229.4238">[38]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="438" x="2541.5" y="3215.5879">Lookup Payee Information from Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="50" x="2547.5" y="3243.2598">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="47" x="2603.5" y="3243.2598">GET</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="71" x="2656.5" y="3243.2598">/parties</text><polygon fill="#383838" points="2045.5,3300.7656,2035.5,3304.7656,2045.5,3308.7656,2041.5,3304.7656" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2039.5" x2="2491.5" y1="3304.7656" y2="3304.7656"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2051.5" y="3297.9316">[39]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="2093.5" y="3297.9316">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="258" x="2145.5" y="3297.9316">/parties/{Type}/{ID}/{SubId}</text><polygon fill="#383838" points="2480.5,3342.4375,2490.5,3346.4375,2480.5,3350.4375,2484.5,3346.4375" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2034.5" x2="2486.5" y1="3346.4375" y2="3346.4375"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="3339.6035">[40]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="205" x="2083.5" y="3339.6035">HTTP 200 Response</text><rect fill="#ECECEC" filter="url(#f5wpn67bfdwty)" height="35" style="stroke: #383838; stroke-width: 1.0;" width="132" x="1882" y="3366.4375"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="124" x="1886" y="3393.2754">Accept Party</text><path d="M1765,3414.1094 L1854,3414.1094 L1854,3433.1094 L1844,3443.1094 L1765,3443.1094 L1765,3414.1094 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="584.0781" style="stroke: #000000; stroke-width: 2.0;" width="1085.5" x="1765" y="3414.1094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1780" y="3437.9473">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="729" x="1869" y="3438.9473">[Quote Processing (M times &amp; within bulkExpiration timelimit in parallel)]</text><polygon fill="#ECECEC" filter="url(#f5wpn67bfdwty)" points="1785,3461.4531,2004,3461.4531,2014,3492.4531,2004,3524.4531,1785,3524.4531,1775,3492.4531,1785,3461.4531" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="215" x="1787" y="3488.291">For each payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="153" x="1787" y="3515.9629">in bulk message</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2076.5" y1="3563.4688" y2="3563.4688"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2076.5" x2="2076.5" y1="3563.4688" y2="3576.4688"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2035.5" x2="2076.5" y1="3576.4688" y2="3576.4688"/><polygon fill="#383838" points="2045.5,3572.4688,2035.5,3576.4688,2045.5,3580.4688,2041.5,3576.4688" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="3556.6348">[41]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="199" x="2083.5" y="3556.6348">Check bulkExpiration</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2076.5" y1="3618.1406" y2="3618.1406"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2076.5" x2="2076.5" y1="3618.1406" y2="3631.1406"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2035.5" x2="2076.5" y1="3631.1406" y2="3631.1406"/><polygon fill="#383838" points="2045.5,3627.1406,2035.5,3631.1406,2045.5,3635.1406,2041.5,3631.1406" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="3611.3066">[42]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="239" x="2083.5" y="3611.3066">Create bulkTransactionId</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2076.5" y1="3728.1563" y2="3728.1563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2076.5" x2="2076.5" y1="3728.1563" y2="3741.1563"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2035.5" x2="2076.5" y1="3741.1563" y2="3741.1563"/><polygon fill="#383838" points="2045.5,3737.1563,2035.5,3741.1563,2045.5,3745.1563,2041.5,3741.1563" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="3693.6504">[43]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="194" x="2083.5" y="3665.9785">Calculate bulk expiry</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="391" x="2083.5" y="3693.6504">based on both expirySeconds config and</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="133" x="2083.5" y="3721.3223">bulkExpiration</text><polygon fill="#383838" points="2480.5,3778.8281,2490.5,3782.8281,2480.5,3786.8281,2484.5,3782.8281" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2486.5" y1="3782.8281" y2="3782.8281"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="3775.9941">[44]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="2083.5" y="3775.9941">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="108" x="2151.5" y="3775.9941">/bulkquotes</text><polygon fill="#383838" points="2045.5,3820.5,2035.5,3824.5,2045.5,3828.5,2041.5,3824.5" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2039.5" x2="2491.5" y1="3824.5" y2="3824.5"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2051.5" y="3817.666">[45]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="196" x="2093.5" y="3817.666">HTTP 202 response</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="3893.8438" y2="3893.8438"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="3893.8438" y2="3906.8438"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="3906.8438" y2="3906.8438"/><polygon fill="#383838" points="2503.5,3902.8438,2493.5,3906.8438,2503.5,3910.8438,2499.5,3906.8438" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="3873.1738">[46]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="297" x="2541.5" y="3859.3379">Pass on quote to Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="50" x="2547.5" y="3887.0098">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="2603.5" y="3887.0098">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="108" x="2671.5" y="3887.0098">/bulkquotes</text><polygon fill="#383838" points="2045.5,3944.5156,2035.5,3948.5156,2045.5,3952.5156,2041.5,3948.5156" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2039.5" x2="2491.5" y1="3948.5156" y2="3948.5156"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2051.5" y="3941.6816">[47]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="2093.5" y="3941.6816">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="146" x="2145.5" y="3941.6816">/bulkquotes/{Id}</text><polygon fill="#383838" points="2480.5,3986.1875,2490.5,3990.1875,2480.5,3994.1875,2484.5,3990.1875" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2034.5" x2="2486.5" y1="3990.1875" y2="3990.1875"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="3983.3535">[48]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="205" x="2083.5" y="3983.3535">HTTP 200 Response</text><polygon fill="#383838" points="1083.5,4034.8594,1073.5,4038.8594,1083.5,4042.8594,1079.5,4038.8594" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1077.5" x2="2018.5" y1="4038.8594" y2="4038.8594"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="1089.5" y="4032.0254">[49]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1131.5" y="4032.0254">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="165" x="1183.5" y="4032.0254">/bulktransfers/{Id}</text><polygon fill="#383838" points="131.5,4076.5313,121.5,4080.5313,131.5,4084.5313,127.5,4080.5313" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="125.5" x2="1071.5" y1="4080.5313" y2="4080.5313"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="137.5" y="4073.6973">[50]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="179.5" y="4073.6973">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="209" x="231.5" y="4073.6973">/bulkdisbursement/{Id}</text><line style="stroke: #383838; stroke-width: 1.0;" x1="120.5" x2="162.5" y1="4122.2031" y2="4122.2031"/><line style="stroke: #383838; stroke-width: 1.0;" x1="162.5" x2="162.5" y1="4122.2031" y2="4135.2031"/><line style="stroke: #383838; stroke-width: 1.0;" x1="121.5" x2="162.5" y1="4135.2031" y2="4135.2031"/><polygon fill="#383838" points="131.5,4131.2031,121.5,4135.2031,131.5,4139.2031,127.5,4135.2031" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="127.5" y="4115.3691">[51]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="494" x="169.5" y="4115.3691">Obtain concent from Payer on Fees and Payee Info</text><line style="stroke: #383838; stroke-width: 1.0;" x1="120.5" x2="162.5" y1="4176.875" y2="4176.875"/><line style="stroke: #383838; stroke-width: 1.0;" x1="162.5" x2="162.5" y1="4176.875" y2="4189.875"/><line style="stroke: #383838; stroke-width: 1.0;" x1="121.5" x2="162.5" y1="4189.875" y2="4189.875"/><polygon fill="#383838" points="131.5,4185.875,121.5,4189.875,131.5,4193.875,127.5,4189.875" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="127.5" y="4170.041">[52]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="139" x="169.5" y="4170.041">Reserve funds</text><polygon fill="#383838" points="1060.5,4227.5469,1070.5,4231.5469,1060.5,4235.5469,1064.5,4231.5469" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="120.5" x2="1066.5" y1="4231.5469" y2="4231.5469"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="127.5" y="4224.7129">[53]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="169.5" y="4224.7129">PATCH</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="373" x="252.5" y="4224.7129">/bulkdisbursement/{bulkhometransferId}</text><polygon fill="#383838" points="2012.5,4269.2188,2022.5,4273.2188,2012.5,4277.2188,2016.5,4273.2188" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1072.5" x2="2018.5" y1="4273.2188" y2="4273.2188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="1079.5" y="4266.3848">[54]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="77" x="1121.5" y="4266.3848">PATCH</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="307" x="1204.5" y="4266.3848">/bulktransfers/{bulktransactionId}</text><path d="M1765,4288.2188 L1854,4288.2188 L1854,4307.2188 L1844,4317.2188 L1765,4317.2188 L1765,4288.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="474.0625" style="stroke: #000000; stroke-width: 2.0;" width="1104.5" x="1765" y="4288.2188"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="1780" y="4312.0566">loop</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="760" x="1869" y="4313.0566">[Transfer Processing (M times &amp; within bulkExpiration timelimit  in parallel)]</text><polygon fill="#ECECEC" filter="url(#f5wpn67bfdwty)" points="1785,4335.5625,2004,4335.5625,2014,4366.5625,2004,4398.5625,1785,4398.5625,1775,4366.5625,1785,4335.5625" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="215" x="1787" y="4362.4004">For each payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="153" x="1787" y="4390.0723">in bulk message</text><polygon fill="#383838" points="2480.5,4433.5781,2490.5,4437.5781,2480.5,4441.5781,2484.5,4437.5781" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2034.5" x2="2486.5" y1="4437.5781" y2="4437.5781"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="4430.7441">[55]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="2083.5" y="4430.7441">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="127" x="2151.5" y="4430.7441">/bulktransfers</text><polygon fill="#383838" points="2045.5,4475.25,2035.5,4479.25,2045.5,4483.25,2041.5,4479.25" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2039.5" x2="2491.5" y1="4479.25" y2="4479.25"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2051.5" y="4472.416">[56]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="196" x="2093.5" y="4472.416">HTTP 202 response</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="4520.9219" y2="4520.9219"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="4520.9219" y2="4533.9219"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="4533.9219" y2="4533.9219"/><polygon fill="#383838" points="2503.5,4529.9219,2493.5,4533.9219,2503.5,4537.9219,2499.5,4533.9219" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="4514.0879">[57]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="267" x="2541.5" y="4514.0879">Reserve Payer DFSP funds</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="4603.2656" y2="4603.2656"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="4603.2656" y2="4616.2656"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="4616.2656" y2="4616.2656"/><polygon fill="#383838" points="2503.5,4612.2656,2493.5,4616.2656,2503.5,4620.2656,2499.5,4616.2656" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="4582.5957">[58]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="316" x="2541.5" y="4568.7598">Pass on transfer to Payee DFSP</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="50" x="2547.5" y="4596.4316">using</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="62" x="2603.5" y="4596.4316">POST</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="127" x="2671.5" y="4596.4316">/bulktransfers</text><line style="stroke: #383838; stroke-width: 1.0;" x1="2492.5" x2="2534.5" y1="4657.9375" y2="4657.9375"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2534.5" x2="2534.5" y1="4657.9375" y2="4670.9375"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2493.5" x2="2534.5" y1="4670.9375" y2="4670.9375"/><polygon fill="#383838" points="2503.5,4666.9375,2493.5,4670.9375,2503.5,4674.9375,2499.5,4670.9375" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2499.5" y="4651.1035">[59]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="262" x="2541.5" y="4651.1035">Commit Payer DFSP funds</text><polygon fill="#383838" points="2045.5,4708.6094,2035.5,4712.6094,2045.5,4716.6094,2041.5,4712.6094" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="2039.5" x2="2491.5" y1="4712.6094" y2="4712.6094"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2051.5" y="4705.7754">[60]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="2093.5" y="4705.7754">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="165" x="2145.5" y="4705.7754">/bulktransfers/{Id}</text><polygon fill="#383838" points="2480.5,4750.2813,2490.5,4754.2813,2480.5,4758.2813,2484.5,4754.2813" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="2034.5" x2="2486.5" y1="4754.2813" y2="4754.2813"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="2041.5" y="4747.4473">[61]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="205" x="2083.5" y="4747.4473">HTTP 200 Response</text><polygon fill="#383838" points="1083.5,4798.9531,1073.5,4802.9531,1083.5,4806.9531,1079.5,4802.9531" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="1077.5" x2="2018.5" y1="4802.9531" y2="4802.9531"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="1089.5" y="4796.1191">[62]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="1131.5" y="4796.1191">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="165" x="1183.5" y="4796.1191">/bulktransfers/{Id}</text><polygon fill="#383838" points="131.5,4840.625,121.5,4844.625,131.5,4848.625,127.5,4844.625" style="stroke: #383838; stroke-width: 1.0;"/><line style="stroke: #383838; stroke-width: 1.0;" x1="125.5" x2="1071.5" y1="4844.625" y2="4844.625"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="137.5" y="4837.791">[63]</text><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="179.5" y="4837.791">PUT</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="209" x="231.5" y="4837.791">/bulkdisbursement/{Id}</text><line style="stroke: #383838; stroke-width: 1.0;" x1="120.5" x2="162.5" y1="4886.2969" y2="4886.2969"/><line style="stroke: #383838; stroke-width: 1.0;" x1="162.5" x2="162.5" y1="4886.2969" y2="4899.2969"/><line style="stroke: #383838; stroke-width: 1.0;" x1="121.5" x2="162.5" y1="4899.2969" y2="4899.2969"/><polygon fill="#383838" points="131.5,4895.2969,121.5,4899.2969,131.5,4903.2969,127.5,4899.2969" style="stroke: #383838; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="22" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="38" x="127.5" y="4879.4629">[64]</text><text fill="#000000" font-family="sans-serif" font-size="22" lengthAdjust="spacingAndGlyphs" textLength="134" x="169.5" y="4879.4629">Commit funds</text><!--MD5=[1fe3f06eb20522f24df8242f5392fdff]
@startuml Payer DFSP Integration Bulk Transactional Flow
/'*****
- - - - - - - - - - - - - -
******'/

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
' declare title
' title Core-Connector transactional flow patterns
' declare actors
participant "Core banking solution" as CBS
box "Payment Manager" #LightGrey
participant "Core\nConnector" as CC 
participant "Mojaloop\nConnector" as MC 
end box
participant "Mojaloop\nSwitch" as Switch
autonumber 1 1 "<b>[0]"

== Payer DFSP integration - 2 phase commit - single phase ==

CBS->CBS: Reserve funds
CBS->CC: **POST** /bulkDisbursement \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true, synchronous = false)
Loop n times  (in parallel)
    hnote left of CC
        For each individual transfer
        in bulk message
    end hnote
    CC -> CC: validate MSISDN & Prefix
end Loop
CC->MC: **POST** /bulkTransfers \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true, synchronous = false)
activate MC
loop N times & within bulkExpiration timelimit  (in parallel)
hnote left of MC
        For each transfer
        in bulk message
end hnote
  MC->Switch: **GET** /parties/{Type}/{ID}/{SubId}
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Determine Payee DFSP using oracle
  Switch->Switch: Lookup Payee Information from Payee DFSP\n using **GET** /parties
  Switch->MC: **PUT** /parties/{Type}/{ID}/{SubId}
  MC- ->Switch: HTTP 200 Response
  MC -> MC: Update transaction status and\n attach get parties response
  MC -> MC: Add to next phase FSP bulk call
end Loop

rnote left MC
  Accept Party
endrnote

loop Quote Processing (M times & within bulkExpiration timelimit in parallel)
  hnote left of MC
          For each payee DFSP
          in bulk message
  end hnote
  MC->MC: Check bulkExpiration
  MC->MC: Create bulkTransactionId
  MC -> MC: Calculate bulk expiry \nbased on both expirySeconds config and \nbulkExpiration
  MC->Switch: **POST** /bulkquotes
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Pass on bulkquote to Payee DFSP\n using **POST** /bulkquotes
  Switch->MC: **PUT** /bulkquotes/{Id}
  MC- ->Switch: HTTP 200 Response
end loop

rnote left MC
  Accept Quote
endrnote
loop Transfer Processing (M times & within bulkExpiration timelimit  in parallel)
  hnote left of MC
        For each payee DFSP
        in bulk message
  end hnote
  MC -> MC: Confirm Fees meets auto accept levels\n and bulkExpiration timelimit not reached \n-> Update Transfer Status

  MC->Switch: **POST** /bulktransfers
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Reserve Payer DFSP funds
  Switch->Switch: Pass on transfer to Payee DFSP\n using **POST** /bulktransfers
  Switch->Switch: Commit Payer DFSP funds
  Switch->MC: **PUT** /bulktransfers/{Id}
  MC- ->Switch: HTTP 200 Response
end loop  

MC->CC: **PUT** /bulktransfers/{Id}

deactivate MC
CC->CBS: **PUT** /bulkdisbursement/{Id}
CBS->CBS: Commit funds

== Payer DFSP integration - 2 phase commit - with user confirmation ==


CBS->CC: **POST** /bulkDisbursement \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = **false**, synchronous = false)
Loop n times  (in parallel)
    hnote left of CC
        For each individual transfer
        in bulk message
    end hnote
    CC -> CC: validate MSISDN & Prefix
end Loop
CC->MC: **POST** /bulkTransfers \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = **false**, synchronous = false)
activate MC
loop N times & within bulkExpiration timelimit  (in parallel)
hnote left of MC
        For each transfer
        in bulk message
end hnote
  activate MC
  MC->Switch: **GET** /parties/{Type}/{ID}/{SubId}
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Determine Payee DFSP using oracle
  Switch->Switch: Lookup Payee Information from Payee DFSP\n using **GET** /parties
  Switch->MC: **PUT** /parties/{Type}/{ID}/{SubId}
  MC- ->Switch: HTTP 200 Response
end Loop

rnote left MC
  Accept Party
endrnote

loop Quote Processing (M times & within bulkExpiration timelimit in parallel)
  hnote left of MC
          For each payee DFSP
          in bulk message
  end hnote
  MC->MC: Check bulkExpiration
  MC->MC: Create bulkTransactionId
  MC -> MC: Calculate bulk expiry \nbased on both expirySeconds config and \nbulkExpiration
  MC->Switch: **POST** /bulkquotes
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Pass on quote to Payee DFSP\n using **POST** /bulkquotes
  Switch->MC: **PUT** /bulkquotes/{Id}
  MC- ->Switch: HTTP 200 Response
end loop
  MC->CC: **PUT** /bulktransfers/{Id}

  deactivate MC
  CC->CBS: **PUT** /bulkdisbursement/{Id}


CBS->CBS: Obtain concent from Payer on Fees and Payee Info
CBS->CBS: Reserve funds
CBS->CC: **PATCH** /bulkdisbursement/{bulkhometransferId}
CC->MC: **PATCH** /bulktransfers/{bulktransactionId}

loop Transfer Processing (M times & within bulkExpiration timelimit  in parallel)
  hnote left of MC
        For each payee DFSP
        in bulk message
  end hnote

  activate MC
  MC->Switch: **POST** /bulktransfers
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Reserve Payer DFSP funds
  Switch->Switch: Pass on transfer to Payee DFSP\n using **POST** /bulktransfers
  Switch->Switch: Commit Payer DFSP funds
  Switch->MC: **PUT** /bulktransfers/{Id}
  MC- ->Switch: HTTP 200 Response
end loop  

MC->CC: **PUT** /bulktransfers/{Id}

deactivate MC
CC->CBS: **PUT** /bulkdisbursement/{Id}
CBS->CBS: Commit funds

@enduml

@startuml Payer DFSP Integration Bulk Transactional Flow

skinparam activityFontSize 4
skinparam activityDiamondFontSize 30
skinparam activityArrowFontSize 22
skinparam defaultFontSize 22
skinparam noteFontSize 22
skinparam monochrome true
participant "Core banking solution" as CBS
box "Payment Manager" #LightGrey
participant "Core\nConnector" as CC 
participant "Mojaloop\nConnector" as MC 
end box
participant "Mojaloop\nSwitch" as Switch
autonumber 1 1 "<b>[0]"

== Payer DFSP integration - 2 phase commit - single phase ==

CBS->CBS: Reserve funds
CBS->CC: **POST** /bulkDisbursement \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true, synchronous = false)
Loop n times  (in parallel)
    hnote left of CC
        For each individual transfer
        in bulk message
    end hnote
    CC -> CC: validate MSISDN & Prefix
end Loop
CC->MC: **POST** /bulkTransfers \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = true, synchronous = false)
activate MC
loop N times & within bulkExpiration timelimit  (in parallel)
hnote left of MC
        For each transfer
        in bulk message
end hnote
  MC->Switch: **GET** /parties/{Type}/{ID}/{SubId}
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Determine Payee DFSP using oracle
  Switch->Switch: Lookup Payee Information from Payee DFSP\n using **GET** /parties
  Switch->MC: **PUT** /parties/{Type}/{ID}/{SubId}
  MC- ->Switch: HTTP 200 Response
  MC -> MC: Update transaction status and\n attach get parties response
  MC -> MC: Add to next phase FSP bulk call
end Loop

rnote left MC
  Accept Party
endrnote

loop Quote Processing (M times & within bulkExpiration timelimit in parallel)
  hnote left of MC
          For each payee DFSP
          in bulk message
  end hnote
  MC->MC: Check bulkExpiration
  MC->MC: Create bulkTransactionId
  MC -> MC: Calculate bulk expiry \nbased on both expirySeconds config and \nbulkExpiration
  MC->Switch: **POST** /bulkquotes
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Pass on bulkquote to Payee DFSP\n using **POST** /bulkquotes
  Switch->MC: **PUT** /bulkquotes/{Id}
  MC- ->Switch: HTTP 200 Response
end loop

rnote left MC
  Accept Quote
endrnote
loop Transfer Processing (M times & within bulkExpiration timelimit  in parallel)
  hnote left of MC
        For each payee DFSP
        in bulk message
  end hnote
  MC -> MC: Confirm Fees meets auto accept levels\n and bulkExpiration timelimit not reached \n-> Update Transfer Status

  MC->Switch: **POST** /bulktransfers
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Reserve Payer DFSP funds
  Switch->Switch: Pass on transfer to Payee DFSP\n using **POST** /bulktransfers
  Switch->Switch: Commit Payer DFSP funds
  Switch->MC: **PUT** /bulktransfers/{Id}
  MC- ->Switch: HTTP 200 Response
end loop  

MC->CC: **PUT** /bulktransfers/{Id}

deactivate MC
CC->CBS: **PUT** /bulkdisbursement/{Id}
CBS->CBS: Commit funds

== Payer DFSP integration - 2 phase commit - with user confirmation ==


CBS->CC: **POST** /bulkDisbursement \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = **false**, synchronous = false)
Loop n times  (in parallel)
    hnote left of CC
        For each individual transfer
        in bulk message
    end hnote
    CC -> CC: validate MSISDN & Prefix
end Loop
CC->MC: **POST** /bulkTransfers \n(AUTO_ACCEPT_PARTY = true, AUTO_ACCEPT_QUOTES = **false**, synchronous = false)
activate MC
loop N times & within bulkExpiration timelimit  (in parallel)
hnote left of MC
        For each transfer
        in bulk message
end hnote
  activate MC
  MC->Switch: **GET** /parties/{Type}/{ID}/{SubId}
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Determine Payee DFSP using oracle
  Switch->Switch: Lookup Payee Information from Payee DFSP\n using **GET** /parties
  Switch->MC: **PUT** /parties/{Type}/{ID}/{SubId}
  MC- ->Switch: HTTP 200 Response
end Loop

rnote left MC
  Accept Party
endrnote

loop Quote Processing (M times & within bulkExpiration timelimit in parallel)
  hnote left of MC
          For each payee DFSP
          in bulk message
  end hnote
  MC->MC: Check bulkExpiration
  MC->MC: Create bulkTransactionId
  MC -> MC: Calculate bulk expiry \nbased on both expirySeconds config and \nbulkExpiration
  MC->Switch: **POST** /bulkquotes
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Pass on quote to Payee DFSP\n using **POST** /bulkquotes
  Switch->MC: **PUT** /bulkquotes/{Id}
  MC- ->Switch: HTTP 200 Response
end loop
  MC->CC: **PUT** /bulktransfers/{Id}

  deactivate MC
  CC->CBS: **PUT** /bulkdisbursement/{Id}


CBS->CBS: Obtain concent from Payer on Fees and Payee Info
CBS->CBS: Reserve funds
CBS->CC: **PATCH** /bulkdisbursement/{bulkhometransferId}
CC->MC: **PATCH** /bulktransfers/{bulktransactionId}

loop Transfer Processing (M times & within bulkExpiration timelimit  in parallel)
  hnote left of MC
        For each payee DFSP
        in bulk message
  end hnote

  activate MC
  MC->Switch: **POST** /bulktransfers
  Switch- ->MC: HTTP 202 response
  Switch->Switch: Reserve Payer DFSP funds
  Switch->Switch: Pass on transfer to Payee DFSP\n using **POST** /bulktransfers
  Switch->Switch: Commit Payer DFSP funds
  Switch->MC: **PUT** /bulktransfers/{Id}
  MC- ->Switch: HTTP 200 Response
end loop  

MC->CC: **PUT** /bulktransfers/{Id}

deactivate MC
CC->CBS: **PUT** /bulkdisbursement/{Id}
CBS->CBS: Commit funds

@enduml

PlantUML version 1.2020.13(Sat Jun 13 13:26:38 BST 2020)
(APACHE source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: GB
--></g></svg>